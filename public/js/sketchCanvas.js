let canvasWidth = 0;
let canvasHeight = 0;

let path;
let overlay;
let sketch = [];

let overlayColor = "#000000";
let annotationColor = "#ff0000";
let fillColor = "#ff000044";

let pointData = [];
let strokeData = [];

let identifyController;

let studentAnswers = { 
    outlineTries: 0,
    widthTries: 0,
    heightTries: 0,
    variation: '',
    shape: '',
    size: '',
    ornamentation: '',
    species: ''
}

let speciesData = { 
    species: 'whatever',
    variation: 'left',
    image: '',
    width: 0,
    height: 0,

    //Correct choices
    shape: '',
    size: '',
    ornamentation: '',

    //Sketch Data
    mmScale: 0.08,
    canvasWidth: 1920,
    canvasHeight: 941,
    outline: [{"x":832,"y":116,"id":0},{"x":833,"y":116,"id":1},{"x":835,"y":116,"id":2},{"x":837,"y":117,"id":3},{"x":840,"y":118,"id":4},{"x":843,"y":119,"id":5},{"x":846,"y":119,"id":6},{"x":850,"y":121,"id":7},{"x":852,"y":121,"id":8},{"x":857,"y":122,"id":9},{"x":858,"y":122,"id":10},{"x":859,"y":122,"id":11},{"x":859,"y":123,"id":12},{"x":860,"y":123,"id":13},{"x":861,"y":123,"id":14},{"x":862,"y":124,"id":15},{"x":864,"y":124,"id":16},{"x":867,"y":125,"id":17},{"x":870,"y":126,"id":18},{"x":874,"y":127,"id":19},{"x":877,"y":128,"id":20},{"x":880,"y":130,"id":21},{"x":882,"y":130,"id":22},{"x":883,"y":130,"id":23},{"x":884,"y":130,"id":24},{"x":885,"y":131,"id":25},{"x":888,"y":131,"id":26},{"x":890,"y":132,"id":27},{"x":892,"y":133,"id":28},{"x":893,"y":133,"id":29},{"x":894,"y":133,"id":30},{"x":895,"y":133,"id":31},{"x":897,"y":134,"id":32},{"x":899,"y":134,"id":33},{"x":900,"y":134,"id":34},{"x":903,"y":134,"id":35},{"x":905,"y":134,"id":36},{"x":906,"y":134,"id":37},{"x":909,"y":134,"id":38},{"x":912,"y":134,"id":39},{"x":914,"y":135,"id":40},{"x":918,"y":135,"id":41},{"x":921,"y":135,"id":42},{"x":924,"y":135,"id":43},{"x":928,"y":136,"id":44},{"x":931,"y":136,"id":45},{"x":936,"y":136,"id":46},{"x":940,"y":136,"id":47},{"x":944,"y":136,"id":48},{"x":946,"y":136,"id":49},{"x":950,"y":136,"id":50},{"x":953,"y":137,"id":51},{"x":957,"y":137,"id":52},{"x":960,"y":137,"id":53},{"x":964,"y":137,"id":54},{"x":970,"y":138,"id":55},{"x":976,"y":139,"id":56},{"x":981,"y":139,"id":57},{"x":986,"y":140,"id":58},{"x":990,"y":140,"id":59},{"x":995,"y":141,"id":60},{"x":1001,"y":141,"id":61},{"x":1004,"y":141,"id":62},{"x":1009,"y":141,"id":63},{"x":1014,"y":142,"id":64},{"x":1017,"y":142,"id":65},{"x":1021,"y":143,"id":66},{"x":1023,"y":143,"id":67},{"x":1027,"y":143,"id":68},{"x":1030,"y":143,"id":69},{"x":1034,"y":144,"id":70},{"x":1037,"y":144,"id":71},{"x":1041,"y":144,"id":72},{"x":1043,"y":145,"id":73},{"x":1046,"y":145,"id":74},{"x":1048,"y":145,"id":75},{"x":1051,"y":145,"id":76},{"x":1052,"y":145,"id":77},{"x":1054,"y":145,"id":78},{"x":1055,"y":145,"id":79},{"x":1057,"y":145,"id":80},{"x":1060,"y":146,"id":81},{"x":1063,"y":146,"id":82},{"x":1068,"y":147,"id":83},{"x":1072,"y":147,"id":84},{"x":1077,"y":148,"id":85},{"x":1081,"y":149,"id":86},{"x":1085,"y":150,"id":87},{"x":1088,"y":150,"id":88},{"x":1091,"y":151,"id":89},{"x":1095,"y":152,"id":90},{"x":1103,"y":152,"id":91},{"x":1109,"y":153,"id":92},{"x":1113,"y":154,"id":93},{"x":1119,"y":155,"id":94},{"x":1125,"y":156,"id":95},{"x":1129,"y":157,"id":96},{"x":1132,"y":158,"id":97},{"x":1135,"y":158,"id":98},{"x":1137,"y":159,"id":99},{"x":1139,"y":159,"id":100},{"x":1141,"y":160,"id":101},{"x":1146,"y":160,"id":102},{"x":1150,"y":161,"id":103},{"x":1154,"y":162,"id":104},{"x":1158,"y":163,"id":105},{"x":1164,"y":164,"id":106},{"x":1167,"y":165,"id":107},{"x":1173,"y":168,"id":108},{"x":1181,"y":169,"id":109},{"x":1187,"y":172,"id":110},{"x":1193,"y":173,"id":111},{"x":1199,"y":174,"id":112},{"x":1202,"y":176,"id":113},{"x":1206,"y":176,"id":114},{"x":1209,"y":177,"id":115},{"x":1212,"y":178,"id":116},{"x":1215,"y":178,"id":117},{"x":1217,"y":178,"id":118},{"x":1219,"y":179,"id":119},{"x":1221,"y":180,"id":120},{"x":1223,"y":180,"id":121},{"x":1224,"y":181,"id":122},{"x":1226,"y":181,"id":123},{"x":1228,"y":183,"id":124},{"x":1231,"y":183,"id":125},{"x":1235,"y":185,"id":126},{"x":1242,"y":186,"id":127},{"x":1247,"y":188,"id":128},{"x":1255,"y":189,"id":129},{"x":1261,"y":191,"id":130},{"x":1267,"y":192,"id":131},{"x":1274,"y":193,"id":132},{"x":1276,"y":194,"id":133},{"x":1279,"y":194,"id":134},{"x":1281,"y":195,"id":135},{"x":1284,"y":195,"id":136},{"x":1286,"y":196,"id":137},{"x":1287,"y":196,"id":138},{"x":1289,"y":196,"id":139},{"x":1292,"y":197,"id":140},{"x":1294,"y":198,"id":141},{"x":1297,"y":198,"id":142},{"x":1300,"y":199,"id":143},{"x":1304,"y":201,"id":144},{"x":1308,"y":202,"id":145},{"x":1316,"y":205,"id":146},{"x":1320,"y":206,"id":147},{"x":1325,"y":208,"id":148},{"x":1329,"y":210,"id":149},{"x":1332,"y":212,"id":150},{"x":1336,"y":214,"id":151},{"x":1338,"y":216,"id":152},{"x":1341,"y":216,"id":153},{"x":1342,"y":217,"id":154},{"x":1343,"y":218,"id":155},{"x":1344,"y":218,"id":156},{"x":1346,"y":220,"id":157},{"x":1348,"y":222,"id":158},{"x":1350,"y":223,"id":159},{"x":1356,"y":226,"id":160},{"x":1362,"y":231,"id":161},{"x":1368,"y":234,"id":162},{"x":1374,"y":237,"id":163},{"x":1379,"y":239,"id":164},{"x":1383,"y":241,"id":165},{"x":1387,"y":243,"id":166},{"x":1390,"y":244,"id":167},{"x":1391,"y":245,"id":168},{"x":1393,"y":247,"id":169},{"x":1395,"y":248,"id":170},{"x":1396,"y":248,"id":171},{"x":1398,"y":250,"id":172},{"x":1399,"y":250,"id":173},{"x":1400,"y":251,"id":174},{"x":1405,"y":254,"id":175},{"x":1410,"y":256,"id":176},{"x":1414,"y":259,"id":177},{"x":1417,"y":262,"id":178},{"x":1420,"y":264,"id":179},{"x":1421,"y":266,"id":180},{"x":1423,"y":268,"id":181},{"x":1425,"y":271,"id":182},{"x":1427,"y":274,"id":183},{"x":1429,"y":277,"id":184},{"x":1432,"y":279,"id":185},{"x":1435,"y":283,"id":186},{"x":1437,"y":286,"id":187},{"x":1439,"y":288,"id":188},{"x":1441,"y":289,"id":189},{"x":1442,"y":291,"id":190},{"x":1445,"y":294,"id":191},{"x":1448,"y":296,"id":192},{"x":1451,"y":299,"id":193},{"x":1452,"y":301,"id":194},{"x":1455,"y":303,"id":195},{"x":1458,"y":307,"id":196},{"x":1461,"y":309,"id":197},{"x":1463,"y":311,"id":198},{"x":1464,"y":313,"id":199},{"x":1466,"y":314,"id":200},{"x":1467,"y":316,"id":201},{"x":1469,"y":318,"id":202},{"x":1471,"y":319,"id":203},{"x":1472,"y":321,"id":204},{"x":1473,"y":322,"id":205},{"x":1474,"y":324,"id":206},{"x":1476,"y":325,"id":207},{"x":1478,"y":328,"id":208},{"x":1480,"y":331,"id":209},{"x":1483,"y":334,"id":210},{"x":1485,"y":336,"id":211},{"x":1486,"y":339,"id":212},{"x":1488,"y":341,"id":213},{"x":1490,"y":345,"id":214},{"x":1492,"y":349,"id":215},{"x":1496,"y":354,"id":216},{"x":1499,"y":358,"id":217},{"x":1501,"y":361,"id":218},{"x":1501,"y":363,"id":219},{"x":1502,"y":364,"id":220},{"x":1503,"y":365,"id":221},{"x":1504,"y":366,"id":222},{"x":1505,"y":369,"id":223},{"x":1507,"y":372,"id":224},{"x":1509,"y":375,"id":225},{"x":1512,"y":376,"id":226},{"x":1513,"y":378,"id":227},{"x":1513,"y":379,"id":228},{"x":1516,"y":381,"id":229},{"x":1517,"y":384,"id":230},{"x":1520,"y":386,"id":231},{"x":1521,"y":389,"id":232},{"x":1523,"y":391,"id":233},{"x":1526,"y":392,"id":234},{"x":1528,"y":393,"id":235},{"x":1528,"y":394,"id":236},{"x":1529,"y":395,"id":237},{"x":1530,"y":397,"id":238},{"x":1532,"y":399,"id":239},{"x":1535,"y":402,"id":240},{"x":1538,"y":406,"id":241},{"x":1541,"y":408,"id":242},{"x":1542,"y":409,"id":243},{"x":1542,"y":410,"id":244},{"x":1544,"y":412,"id":245},{"x":1546,"y":415,"id":246},{"x":1547,"y":418,"id":247},{"x":1549,"y":420,"id":248},{"x":1550,"y":421,"id":249},{"x":1551,"y":422,"id":250},{"x":1552,"y":425,"id":251},{"x":1554,"y":428,"id":252},{"x":1556,"y":431,"id":253},{"x":1556,"y":433,"id":254},{"x":1558,"y":434,"id":255},{"x":1558,"y":435,"id":256},{"x":1559,"y":437,"id":257},{"x":1559,"y":439,"id":258},{"x":1561,"y":442,"id":259},{"x":1562,"y":444,"id":260},{"x":1564,"y":446,"id":261},{"x":1565,"y":448,"id":262},{"x":1566,"y":450,"id":263},{"x":1567,"y":452,"id":264},{"x":1568,"y":453,"id":265},{"x":1568,"y":454,"id":266},{"x":1569,"y":456,"id":267},{"x":1570,"y":459,"id":268},{"x":1572,"y":462,"id":269},{"x":1573,"y":463,"id":270},{"x":1573,"y":464,"id":271},{"x":1574,"y":466,"id":272},{"x":1574,"y":467,"id":273},{"x":1574,"y":469,"id":274},{"x":1574,"y":470,"id":275},{"x":1574,"y":471,"id":276},{"x":1576,"y":473,"id":277},{"x":1576,"y":476,"id":278},{"x":1577,"y":477,"id":279},{"x":1578,"y":478,"id":280},{"x":1578,"y":479,"id":281},{"x":1578,"y":480,"id":282},{"x":1578,"y":481,"id":283},{"x":1579,"y":483,"id":284},{"x":1580,"y":486,"id":285},{"x":1581,"y":489,"id":286},{"x":1582,"y":490,"id":287},{"x":1583,"y":491,"id":288},{"x":1583,"y":492,"id":289},{"x":1584,"y":493,"id":290},{"x":1584,"y":494,"id":291},{"x":1584,"y":497,"id":292},{"x":1585,"y":498,"id":293},{"x":1586,"y":501,"id":294},{"x":1587,"y":503,"id":295},{"x":1588,"y":505,"id":296},{"x":1588,"y":506,"id":297},{"x":1589,"y":509,"id":298},{"x":1591,"y":514,"id":299},{"x":1593,"y":520,"id":300},{"x":1595,"y":525,"id":301},{"x":1597,"y":531,"id":302},{"x":1598,"y":534,"id":303},{"x":1599,"y":539,"id":304},{"x":1600,"y":544,"id":305},{"x":1602,"y":547,"id":306},{"x":1602,"y":548,"id":307},{"x":1602,"y":550,"id":308},{"x":1603,"y":554,"id":309},{"x":1603,"y":559,"id":310},{"x":1603,"y":564,"id":311},{"x":1604,"y":568,"id":312},{"x":1604,"y":572,"id":313},{"x":1605,"y":575,"id":314},{"x":1606,"y":579,"id":315},{"x":1606,"y":583,"id":316},{"x":1606,"y":586,"id":317},{"x":1606,"y":589,"id":318},{"x":1606,"y":594,"id":319},{"x":1606,"y":597,"id":320},{"x":1606,"y":598,"id":321},{"x":1606,"y":599,"id":322},{"x":1606,"y":602,"id":323},{"x":1606,"y":605,"id":324},{"x":1606,"y":609,"id":325},{"x":1606,"y":611,"id":326},{"x":1606,"y":612,"id":327},{"x":1606,"y":613,"id":328},{"x":1606,"y":615,"id":329},{"x":1607,"y":619,"id":330},{"x":1607,"y":621,"id":331},{"x":1607,"y":623,"id":332},{"x":1607,"y":625,"id":333},{"x":1607,"y":627,"id":334},{"x":1607,"y":631,"id":335},{"x":1607,"y":634,"id":336},{"x":1607,"y":638,"id":337},{"x":1607,"y":640,"id":338},{"x":1607,"y":644,"id":339},{"x":1607,"y":647,"id":340},{"x":1606,"y":650,"id":341},{"x":1606,"y":652,"id":342},{"x":1604,"y":656,"id":343},{"x":1603,"y":658,"id":344},{"x":1601,"y":661,"id":345},{"x":1599,"y":665,"id":346},{"x":1598,"y":668,"id":347},{"x":1597,"y":671,"id":348},{"x":1596,"y":674,"id":349},{"x":1595,"y":674,"id":350},{"x":1595,"y":675,"id":351},{"x":1594,"y":677,"id":352},{"x":1594,"y":679,"id":353},{"x":1593,"y":681,"id":354},{"x":1592,"y":682,"id":355},{"x":1591,"y":685,"id":356},{"x":1591,"y":687,"id":357},{"x":1590,"y":688,"id":358},{"x":1590,"y":690,"id":359},{"x":1589,"y":691,"id":360},{"x":1588,"y":694,"id":361},{"x":1587,"y":697,"id":362},{"x":1586,"y":699,"id":363},{"x":1585,"y":702,"id":364},{"x":1584,"y":703,"id":365},{"x":1584,"y":705,"id":366},{"x":1582,"y":707,"id":367},{"x":1582,"y":708,"id":368},{"x":1581,"y":710,"id":369},{"x":1578,"y":715,"id":370},{"x":1577,"y":718,"id":371},{"x":1576,"y":719,"id":372},{"x":1575,"y":721,"id":373},{"x":1575,"y":723,"id":374},{"x":1573,"y":725,"id":375},{"x":1572,"y":726,"id":376},{"x":1572,"y":728,"id":377},{"x":1571,"y":730,"id":378},{"x":1569,"y":733,"id":379},{"x":1568,"y":735,"id":380},{"x":1566,"y":738,"id":381},{"x":1564,"y":742,"id":382},{"x":1563,"y":744,"id":383},{"x":1562,"y":746,"id":384},{"x":1559,"y":749,"id":385},{"x":1558,"y":750,"id":386},{"x":1557,"y":752,"id":387},{"x":1557,"y":754,"id":388},{"x":1557,"y":756,"id":389},{"x":1555,"y":759,"id":390},{"x":1553,"y":760,"id":391},{"x":1551,"y":763,"id":392},{"x":1548,"y":765,"id":393},{"x":1546,"y":768,"id":394},{"x":1544,"y":770,"id":395},{"x":1540,"y":773,"id":396},{"x":1532,"y":778,"id":397},{"x":1527,"y":780,"id":398},{"x":1524,"y":782,"id":399},{"x":1519,"y":785,"id":400},{"x":1515,"y":787,"id":401},{"x":1512,"y":788,"id":402},{"x":1511,"y":789,"id":403},{"x":1510,"y":789,"id":404},{"x":1508,"y":791,"id":405},{"x":1507,"y":791,"id":406},{"x":1505,"y":792,"id":407},{"x":1504,"y":793,"id":408},{"x":1501,"y":795,"id":409},{"x":1499,"y":795,"id":410},{"x":1496,"y":797,"id":411},{"x":1494,"y":797,"id":412},{"x":1493,"y":798,"id":413},{"x":1491,"y":798,"id":414},{"x":1489,"y":799,"id":415},{"x":1486,"y":800,"id":416},{"x":1480,"y":801,"id":417},{"x":1478,"y":801,"id":418},{"x":1475,"y":802,"id":419},{"x":1470,"y":802,"id":420},{"x":1468,"y":803,"id":421},{"x":1465,"y":803,"id":422},{"x":1462,"y":804,"id":423},{"x":1460,"y":805,"id":424},{"x":1458,"y":805,"id":425},{"x":1455,"y":806,"id":426},{"x":1454,"y":807,"id":427},{"x":1453,"y":807,"id":428},{"x":1451,"y":808,"id":429},{"x":1447,"y":809,"id":430},{"x":1445,"y":811,"id":431},{"x":1442,"y":811,"id":432},{"x":1440,"y":812,"id":433},{"x":1438,"y":813,"id":434},{"x":1436,"y":813,"id":435},{"x":1434,"y":814,"id":436},{"x":1431,"y":815,"id":437},{"x":1429,"y":816,"id":438},{"x":1427,"y":816,"id":439},{"x":1424,"y":817,"id":440},{"x":1423,"y":818,"id":441},{"x":1422,"y":818,"id":442},{"x":1421,"y":818,"id":443},{"x":1420,"y":818,"id":444},{"x":1417,"y":819,"id":445},{"x":1415,"y":819,"id":446},{"x":1412,"y":820,"id":447},{"x":1409,"y":821,"id":448},{"x":1407,"y":821,"id":449},{"x":1404,"y":821,"id":450},{"x":1402,"y":822,"id":451},{"x":1399,"y":823,"id":452},{"x":1397,"y":823,"id":453},{"x":1395,"y":824,"id":454},{"x":1389,"y":825,"id":455},{"x":1386,"y":825,"id":456},{"x":1381,"y":825,"id":457},{"x":1377,"y":825,"id":458},{"x":1374,"y":825,"id":459},{"x":1370,"y":826,"id":460},{"x":1367,"y":826,"id":461},{"x":1365,"y":826,"id":462},{"x":1363,"y":826,"id":463},{"x":1360,"y":826,"id":464},{"x":1359,"y":826,"id":465},{"x":1355,"y":826,"id":466},{"x":1354,"y":826,"id":467},{"x":1352,"y":827,"id":468},{"x":1349,"y":827,"id":469},{"x":1348,"y":827,"id":470},{"x":1347,"y":827,"id":471},{"x":1344,"y":828,"id":472},{"x":1342,"y":828,"id":473},{"x":1340,"y":828,"id":474},{"x":1336,"y":828,"id":475},{"x":1333,"y":829,"id":476},{"x":1329,"y":830,"id":477},{"x":1326,"y":831,"id":478},{"x":1322,"y":831,"id":479},{"x":1318,"y":831,"id":480},{"x":1315,"y":832,"id":481},{"x":1314,"y":832,"id":482},{"x":1309,"y":832,"id":483},{"x":1307,"y":833,"id":484},{"x":1304,"y":833,"id":485},{"x":1301,"y":834,"id":486},{"x":1298,"y":834,"id":487},{"x":1295,"y":834,"id":488},{"x":1292,"y":834,"id":489},{"x":1289,"y":834,"id":490},{"x":1285,"y":834,"id":491},{"x":1280,"y":834,"id":492},{"x":1276,"y":833,"id":493},{"x":1272,"y":833,"id":494},{"x":1266,"y":833,"id":495},{"x":1263,"y":833,"id":496},{"x":1261,"y":833,"id":497},{"x":1258,"y":833,"id":498},{"x":1255,"y":833,"id":499},{"x":1251,"y":833,"id":500},{"x":1248,"y":832,"id":501},{"x":1246,"y":832,"id":502},{"x":1244,"y":832,"id":503},{"x":1240,"y":832,"id":504},{"x":1237,"y":832,"id":505},{"x":1234,"y":831,"id":506},{"x":1230,"y":831,"id":507},{"x":1227,"y":831,"id":508},{"x":1223,"y":831,"id":509},{"x":1219,"y":831,"id":510},{"x":1215,"y":831,"id":511},{"x":1211,"y":831,"id":512},{"x":1208,"y":831,"id":513},{"x":1202,"y":831,"id":514},{"x":1197,"y":831,"id":515},{"x":1192,"y":830,"id":516},{"x":1189,"y":830,"id":517},{"x":1187,"y":830,"id":518},{"x":1183,"y":829,"id":519},{"x":1181,"y":829,"id":520},{"x":1179,"y":829,"id":521},{"x":1177,"y":829,"id":522},{"x":1174,"y":830,"id":523},{"x":1169,"y":830,"id":524},{"x":1166,"y":831,"id":525},{"x":1163,"y":832,"id":526},{"x":1160,"y":832,"id":527},{"x":1158,"y":833,"id":528},{"x":1154,"y":833,"id":529},{"x":1152,"y":834,"id":530},{"x":1148,"y":834,"id":531},{"x":1145,"y":834,"id":532},{"x":1142,"y":834,"id":533},{"x":1140,"y":834,"id":534},{"x":1137,"y":834,"id":535},{"x":1134,"y":834,"id":536},{"x":1133,"y":834,"id":537},{"x":1131,"y":834,"id":538},{"x":1128,"y":835,"id":539},{"x":1126,"y":835,"id":540},{"x":1124,"y":835,"id":541},{"x":1122,"y":835,"id":542},{"x":1120,"y":835,"id":543},{"x":1117,"y":835,"id":544},{"x":1116,"y":835,"id":545},{"x":1114,"y":835,"id":546},{"x":1111,"y":835,"id":547},{"x":1108,"y":835,"id":548},{"x":1103,"y":835,"id":549},{"x":1098,"y":834,"id":550},{"x":1094,"y":833,"id":551},{"x":1091,"y":833,"id":552},{"x":1088,"y":833,"id":553},{"x":1085,"y":832,"id":554},{"x":1083,"y":832,"id":555},{"x":1081,"y":831,"id":556},{"x":1078,"y":831,"id":557},{"x":1077,"y":830,"id":558},{"x":1074,"y":830,"id":559},{"x":1069,"y":830,"id":560},{"x":1065,"y":830,"id":561},{"x":1061,"y":829,"id":562},{"x":1056,"y":827,"id":563},{"x":1053,"y":827,"id":564},{"x":1047,"y":827,"id":565},{"x":1044,"y":827,"id":566},{"x":1043,"y":826,"id":567},{"x":1038,"y":825,"id":568},{"x":1035,"y":825,"id":569},{"x":1034,"y":825,"id":570},{"x":1029,"y":824,"id":571},{"x":1026,"y":824,"id":572},{"x":1024,"y":824,"id":573},{"x":1021,"y":824,"id":574},{"x":1020,"y":823,"id":575},{"x":1017,"y":823,"id":576},{"x":1014,"y":822,"id":577},{"x":1009,"y":822,"id":578},{"x":1005,"y":821,"id":579},{"x":999,"y":820,"id":580},{"x":996,"y":819,"id":581},{"x":993,"y":819,"id":582},{"x":991,"y":818,"id":583},{"x":989,"y":818,"id":584},{"x":986,"y":818,"id":585},{"x":983,"y":817,"id":586},{"x":981,"y":817,"id":587},{"x":978,"y":816,"id":588},{"x":975,"y":816,"id":589},{"x":973,"y":816,"id":590},{"x":971,"y":815,"id":591},{"x":970,"y":815,"id":592},{"x":967,"y":815,"id":593},{"x":965,"y":815,"id":594},{"x":964,"y":815,"id":595},{"x":962,"y":815,"id":596},{"x":958,"y":815,"id":597},{"x":957,"y":815,"id":598},{"x":955,"y":815,"id":599},{"x":952,"y":815,"id":600},{"x":950,"y":815,"id":601},{"x":949,"y":816,"id":602},{"x":947,"y":816,"id":603},{"x":944,"y":816,"id":604},{"x":942,"y":816,"id":605},{"x":939,"y":816,"id":606},{"x":936,"y":816,"id":607},{"x":933,"y":816,"id":608},{"x":931,"y":816,"id":609},{"x":928,"y":816,"id":610},{"x":925,"y":816,"id":611},{"x":923,"y":816,"id":612},{"x":920,"y":816,"id":613},{"x":919,"y":816,"id":614},{"x":916,"y":816,"id":615},{"x":914,"y":816,"id":616},{"x":913,"y":816,"id":617},{"x":910,"y":816,"id":618},{"x":909,"y":816,"id":619},{"x":905,"y":815,"id":620},{"x":903,"y":815,"id":621},{"x":902,"y":815,"id":622},{"x":900,"y":815,"id":623},{"x":898,"y":815,"id":624},{"x":894,"y":815,"id":625},{"x":891,"y":815,"id":626},{"x":890,"y":815,"id":627},{"x":887,"y":815,"id":628},{"x":885,"y":815,"id":629},{"x":881,"y":815,"id":630},{"x":878,"y":815,"id":631},{"x":876,"y":815,"id":632},{"x":873,"y":815,"id":633},{"x":868,"y":815,"id":634},{"x":865,"y":815,"id":635},{"x":863,"y":815,"id":636},{"x":862,"y":816,"id":637},{"x":858,"y":816,"id":638},{"x":855,"y":816,"id":639},{"x":854,"y":817,"id":640},{"x":850,"y":817,"id":641},{"x":849,"y":818,"id":642},{"x":847,"y":818,"id":643},{"x":844,"y":818,"id":644},{"x":842,"y":818,"id":645},{"x":842,"y":819,"id":646},{"x":841,"y":819,"id":647},{"x":839,"y":820,"id":648},{"x":837,"y":820,"id":649},{"x":835,"y":820,"id":650},{"x":833,"y":820,"id":651},{"x":831,"y":820,"id":652},{"x":829,"y":820,"id":653},{"x":827,"y":820,"id":654},{"x":825,"y":820,"id":655},{"x":822,"y":820,"id":656},{"x":821,"y":820,"id":657},{"x":819,"y":820,"id":658},{"x":816,"y":820,"id":659},{"x":814,"y":820,"id":660},{"x":812,"y":820,"id":661},{"x":811,"y":821,"id":662},{"x":809,"y":821,"id":663},{"x":808,"y":822,"id":664},{"x":806,"y":822,"id":665},{"x":803,"y":823,"id":666},{"x":801,"y":824,"id":667},{"x":799,"y":824,"id":668},{"x":798,"y":824,"id":669},{"x":797,"y":825,"id":670},{"x":795,"y":825,"id":671},{"x":794,"y":825,"id":672},{"x":793,"y":826,"id":673},{"x":789,"y":827,"id":674},{"x":786,"y":827,"id":675},{"x":782,"y":827,"id":676},{"x":778,"y":827,"id":677},{"x":775,"y":827,"id":678},{"x":774,"y":827,"id":679},{"x":772,"y":827,"id":680},{"x":770,"y":828,"id":681},{"x":769,"y":828,"id":682},{"x":767,"y":828,"id":683},{"x":765,"y":829,"id":684},{"x":764,"y":829,"id":685},{"x":761,"y":830,"id":686},{"x":759,"y":831,"id":687},{"x":758,"y":831,"id":688},{"x":755,"y":832,"id":689},{"x":753,"y":832,"id":690},{"x":751,"y":832,"id":691},{"x":747,"y":833,"id":692},{"x":744,"y":833,"id":693},{"x":742,"y":833,"id":694},{"x":740,"y":833,"id":695},{"x":737,"y":833,"id":696},{"x":735,"y":833,"id":697},{"x":731,"y":833,"id":698},{"x":726,"y":833,"id":699},{"x":725,"y":833,"id":700},{"x":722,"y":833,"id":701},{"x":720,"y":833,"id":702},{"x":718,"y":832,"id":703},{"x":714,"y":832,"id":704},{"x":712,"y":832,"id":705},{"x":711,"y":832,"id":706},{"x":708,"y":832,"id":707},{"x":706,"y":831,"id":708},{"x":705,"y":831,"id":709},{"x":703,"y":831,"id":710},{"x":701,"y":831,"id":711},{"x":698,"y":830,"id":712},{"x":695,"y":830,"id":713},{"x":692,"y":829,"id":714},{"x":689,"y":828,"id":715},{"x":684,"y":827,"id":716},{"x":681,"y":827,"id":717},{"x":678,"y":825,"id":718},{"x":674,"y":824,"id":719},{"x":671,"y":822,"id":720},{"x":669,"y":822,"id":721},{"x":668,"y":822,"id":722},{"x":664,"y":821,"id":723},{"x":662,"y":821,"id":724},{"x":660,"y":821,"id":725},{"x":656,"y":820,"id":726},{"x":654,"y":820,"id":727},{"x":653,"y":820,"id":728},{"x":652,"y":820,"id":729},{"x":650,"y":820,"id":730},{"x":647,"y":820,"id":731},{"x":646,"y":820,"id":732},{"x":643,"y":820,"id":733},{"x":642,"y":820,"id":734},{"x":639,"y":820,"id":735},{"x":636,"y":820,"id":736},{"x":632,"y":820,"id":737},{"x":630,"y":820,"id":738},{"x":629,"y":820,"id":739},{"x":627,"y":820,"id":740},{"x":626,"y":820,"id":741},{"x":624,"y":820,"id":742},{"x":621,"y":820,"id":743},{"x":618,"y":820,"id":744},{"x":617,"y":820,"id":745},{"x":613,"y":820,"id":746},{"x":609,"y":820,"id":747},{"x":605,"y":820,"id":748},{"x":602,"y":820,"id":749},{"x":600,"y":820,"id":750},{"x":598,"y":819,"id":751},{"x":597,"y":819,"id":752},{"x":596,"y":819,"id":753},{"x":593,"y":819,"id":754},{"x":590,"y":818,"id":755},{"x":585,"y":817,"id":756},{"x":580,"y":815,"id":757},{"x":576,"y":814,"id":758},{"x":574,"y":813,"id":759},{"x":572,"y":811,"id":760},{"x":568,"y":810,"id":761},{"x":566,"y":808,"id":762},{"x":564,"y":807,"id":763},{"x":563,"y":806,"id":764},{"x":563,"y":805,"id":765},{"x":562,"y":805,"id":766},{"x":561,"y":804,"id":767},{"x":560,"y":803,"id":768},{"x":560,"y":802,"id":769},{"x":559,"y":800,"id":770},{"x":557,"y":798,"id":771},{"x":557,"y":797,"id":772},{"x":556,"y":795,"id":773},{"x":555,"y":793,"id":774},{"x":555,"y":791,"id":775},{"x":554,"y":791,"id":776},{"x":554,"y":790,"id":777},{"x":552,"y":789,"id":778},{"x":552,"y":788,"id":779},{"x":551,"y":786,"id":780},{"x":551,"y":785,"id":781},{"x":551,"y":784,"id":782},{"x":551,"y":782,"id":783},{"x":550,"y":781,"id":784},{"x":548,"y":779,"id":785},{"x":548,"y":778,"id":786},{"x":545,"y":776,"id":787},{"x":542,"y":774,"id":788},{"x":541,"y":773,"id":789},{"x":538,"y":770,"id":790},{"x":537,"y":770,"id":791},{"x":537,"y":769,"id":792},{"x":536,"y":768,"id":793},{"x":534,"y":767,"id":794},{"x":532,"y":765,"id":795},{"x":531,"y":764,"id":796},{"x":526,"y":761,"id":797},{"x":525,"y":760,"id":798},{"x":524,"y":760,"id":799},{"x":523,"y":760,"id":800},{"x":521,"y":758,"id":801},{"x":517,"y":756,"id":802},{"x":514,"y":755,"id":803},{"x":513,"y":755,"id":804},{"x":513,"y":754,"id":805},{"x":512,"y":754,"id":806},{"x":509,"y":752,"id":807},{"x":504,"y":751,"id":808},{"x":502,"y":750,"id":809},{"x":500,"y":749,"id":810},{"x":499,"y":749,"id":811},{"x":499,"y":748,"id":812},{"x":498,"y":748,"id":813},{"x":497,"y":746,"id":814},{"x":495,"y":742,"id":815},{"x":492,"y":740,"id":816},{"x":489,"y":738,"id":817},{"x":487,"y":735,"id":818},{"x":487,"y":734,"id":819},{"x":486,"y":734,"id":820},{"x":486,"y":733,"id":821},{"x":485,"y":733,"id":822},{"x":485,"y":732,"id":823},{"x":484,"y":730,"id":824},{"x":480,"y":726,"id":825},{"x":478,"y":723,"id":826},{"x":473,"y":719,"id":827},{"x":470,"y":716,"id":828},{"x":469,"y":715,"id":829},{"x":468,"y":715,"id":830},{"x":468,"y":714,"id":831},{"x":467,"y":713,"id":832},{"x":463,"y":710,"id":833},{"x":462,"y":709,"id":834},{"x":462,"y":708,"id":835},{"x":462,"y":707,"id":836},{"x":461,"y":707,"id":837},{"x":459,"y":704,"id":838},{"x":456,"y":701,"id":839},{"x":454,"y":699,"id":840},{"x":452,"y":698,"id":841},{"x":452,"y":697,"id":842},{"x":451,"y":696,"id":843},{"x":450,"y":693,"id":844},{"x":448,"y":692,"id":845},{"x":447,"y":690,"id":846},{"x":445,"y":687,"id":847},{"x":444,"y":684,"id":848},{"x":442,"y":682,"id":849},{"x":440,"y":680,"id":850},{"x":439,"y":679,"id":851},{"x":437,"y":677,"id":852},{"x":434,"y":674,"id":853},{"x":433,"y":672,"id":854},{"x":431,"y":671,"id":855},{"x":431,"y":670,"id":856},{"x":430,"y":669,"id":857},{"x":428,"y":666,"id":858},{"x":428,"y":665,"id":859},{"x":427,"y":664,"id":860},{"x":425,"y":663,"id":861},{"x":424,"y":660,"id":862},{"x":423,"y":659,"id":863},{"x":422,"y":658,"id":864},{"x":422,"y":656,"id":865},{"x":420,"y":655,"id":866},{"x":419,"y":653,"id":867},{"x":417,"y":651,"id":868},{"x":416,"y":649,"id":869},{"x":415,"y":646,"id":870},{"x":414,"y":644,"id":871},{"x":413,"y":642,"id":872},{"x":412,"y":639,"id":873},{"x":412,"y":638,"id":874},{"x":412,"y":636,"id":875},{"x":412,"y":635,"id":876},{"x":412,"y":633,"id":877},{"x":411,"y":631,"id":878},{"x":410,"y":630,"id":879},{"x":409,"y":627,"id":880},{"x":408,"y":625,"id":881},{"x":407,"y":623,"id":882},{"x":407,"y":622,"id":883},{"x":406,"y":621,"id":884},{"x":406,"y":620,"id":885},{"x":405,"y":618,"id":886},{"x":404,"y":615,"id":887},{"x":403,"y":613,"id":888},{"x":403,"y":611,"id":889},{"x":402,"y":609,"id":890},{"x":402,"y":608,"id":891},{"x":401,"y":607,"id":892},{"x":401,"y":606,"id":893},{"x":401,"y":605,"id":894},{"x":401,"y":604,"id":895},{"x":400,"y":603,"id":896},{"x":400,"y":599,"id":897},{"x":399,"y":596,"id":898},{"x":399,"y":594,"id":899},{"x":399,"y":593,"id":900},{"x":398,"y":591,"id":901},{"x":397,"y":590,"id":902},{"x":397,"y":588,"id":903},{"x":397,"y":587,"id":904},{"x":397,"y":586,"id":905},{"x":397,"y":585,"id":906},{"x":396,"y":583,"id":907},{"x":396,"y":581,"id":908},{"x":396,"y":580,"id":909},{"x":394,"y":576,"id":910},{"x":394,"y":573,"id":911},{"x":393,"y":571,"id":912},{"x":392,"y":570,"id":913},{"x":392,"y":568,"id":914},{"x":391,"y":567,"id":915},{"x":391,"y":566,"id":916},{"x":391,"y":565,"id":917},{"x":391,"y":564,"id":918},{"x":391,"y":563,"id":919},{"x":390,"y":562,"id":920},{"x":390,"y":560,"id":921},{"x":390,"y":559,"id":922},{"x":389,"y":557,"id":923},{"x":389,"y":556,"id":924},{"x":389,"y":555,"id":925},{"x":389,"y":554,"id":926},{"x":389,"y":552,"id":927},{"x":389,"y":551,"id":928},{"x":389,"y":549,"id":929},{"x":389,"y":547,"id":930},{"x":389,"y":546,"id":931},{"x":389,"y":545,"id":932},{"x":389,"y":544,"id":933},{"x":389,"y":542,"id":934},{"x":389,"y":540,"id":935},{"x":389,"y":539,"id":936},{"x":390,"y":538,"id":937},{"x":390,"y":536,"id":938},{"x":390,"y":535,"id":939},{"x":390,"y":533,"id":940},{"x":390,"y":531,"id":941},{"x":390,"y":530,"id":942},{"x":390,"y":529,"id":943},{"x":390,"y":527,"id":944},{"x":390,"y":525,"id":945},{"x":390,"y":524,"id":946},{"x":390,"y":523,"id":947},{"x":391,"y":522,"id":948},{"x":392,"y":520,"id":949},{"x":392,"y":519,"id":950},{"x":392,"y":517,"id":951},{"x":392,"y":516,"id":952},{"x":393,"y":515,"id":953},{"x":393,"y":514,"id":954},{"x":394,"y":512,"id":955},{"x":394,"y":509,"id":956},{"x":396,"y":507,"id":957},{"x":396,"y":506,"id":958},{"x":396,"y":504,"id":959},{"x":396,"y":502,"id":960},{"x":397,"y":500,"id":961},{"x":397,"y":498,"id":962},{"x":398,"y":497,"id":963},{"x":398,"y":495,"id":964},{"x":399,"y":494,"id":965},{"x":399,"y":493,"id":966},{"x":399,"y":491,"id":967},{"x":400,"y":489,"id":968},{"x":400,"y":488,"id":969},{"x":401,"y":487,"id":970},{"x":402,"y":485,"id":971},{"x":402,"y":484,"id":972},{"x":402,"y":483,"id":973},{"x":402,"y":482,"id":974},{"x":403,"y":481,"id":975},{"x":403,"y":479,"id":976},{"x":404,"y":477,"id":977},{"x":404,"y":476,"id":978},{"x":404,"y":475,"id":979},{"x":405,"y":474,"id":980},{"x":405,"y":473,"id":981},{"x":405,"y":472,"id":982},{"x":405,"y":471,"id":983},{"x":405,"y":470,"id":984},{"x":405,"y":469,"id":985},{"x":405,"y":468,"id":986},{"x":405,"y":467,"id":987},{"x":405,"y":465,"id":988},{"x":405,"y":464,"id":989},{"x":406,"y":462,"id":990},{"x":406,"y":461,"id":991},{"x":406,"y":460,"id":992},{"x":406,"y":458,"id":993},{"x":406,"y":457,"id":994},{"x":406,"y":455,"id":995},{"x":406,"y":454,"id":996},{"x":406,"y":453,"id":997},{"x":406,"y":451,"id":998},{"x":406,"y":450,"id":999},{"x":406,"y":448,"id":1000},{"x":406,"y":447,"id":1001},{"x":406,"y":446,"id":1002},{"x":407,"y":445,"id":1003},{"x":407,"y":444,"id":1004},{"x":407,"y":443,"id":1005},{"x":407,"y":442,"id":1006},{"x":407,"y":441,"id":1007},{"x":407,"y":439,"id":1008},{"x":407,"y":438,"id":1009},{"x":407,"y":437,"id":1010},{"x":407,"y":436,"id":1011},{"x":407,"y":435,"id":1012},{"x":407,"y":433,"id":1013},{"x":407,"y":431,"id":1014},{"x":407,"y":430,"id":1015},{"x":407,"y":428,"id":1016},{"x":407,"y":427,"id":1017},{"x":407,"y":426,"id":1018},{"x":406,"y":426,"id":1019},{"x":406,"y":424,"id":1020},{"x":406,"y":423,"id":1021},{"x":406,"y":422,"id":1022},{"x":406,"y":421,"id":1023},{"x":406,"y":420,"id":1024},{"x":406,"y":419,"id":1025},{"x":406,"y":416,"id":1026},{"x":406,"y":415,"id":1027},{"x":407,"y":413,"id":1028},{"x":407,"y":412,"id":1029},{"x":407,"y":411,"id":1030},{"x":407,"y":410,"id":1031},{"x":408,"y":409,"id":1032},{"x":408,"y":408,"id":1033},{"x":410,"y":407,"id":1034},{"x":410,"y":405,"id":1035},{"x":411,"y":404,"id":1036},{"x":411,"y":403,"id":1037},{"x":411,"y":402,"id":1038},{"x":412,"y":400,"id":1039},{"x":414,"y":399,"id":1040},{"x":414,"y":398,"id":1041},{"x":415,"y":397,"id":1042},{"x":416,"y":396,"id":1043},{"x":416,"y":395,"id":1044},{"x":417,"y":394,"id":1045},{"x":418,"y":393,"id":1046},{"x":418,"y":392,"id":1047},{"x":419,"y":391,"id":1048},{"x":419,"y":390,"id":1049},{"x":420,"y":388,"id":1050},{"x":420,"y":387,"id":1051},{"x":421,"y":385,"id":1052},{"x":422,"y":384,"id":1053},{"x":424,"y":382,"id":1054},{"x":424,"y":380,"id":1055},{"x":426,"y":378,"id":1056},{"x":428,"y":375,"id":1057},{"x":430,"y":373,"id":1058},{"x":431,"y":371,"id":1059},{"x":432,"y":370,"id":1060},{"x":433,"y":368,"id":1061},{"x":435,"y":367,"id":1062},{"x":436,"y":365,"id":1063},{"x":437,"y":363,"id":1064},{"x":439,"y":361,"id":1065},{"x":440,"y":359,"id":1066},{"x":440,"y":358,"id":1067},{"x":442,"y":356,"id":1068},{"x":443,"y":354,"id":1069},{"x":444,"y":352,"id":1070},{"x":446,"y":350,"id":1071},{"x":448,"y":348,"id":1072},{"x":449,"y":346,"id":1073},{"x":450,"y":345,"id":1074},{"x":450,"y":343,"id":1075},{"x":451,"y":342,"id":1076},{"x":452,"y":340,"id":1077},{"x":453,"y":340,"id":1078},{"x":454,"y":338,"id":1079},{"x":455,"y":336,"id":1080},{"x":455,"y":335,"id":1081},{"x":456,"y":334,"id":1082},{"x":457,"y":333,"id":1083},{"x":459,"y":331,"id":1084},{"x":461,"y":328,"id":1085},{"x":463,"y":326,"id":1086},{"x":464,"y":325,"id":1087},{"x":467,"y":322,"id":1088},{"x":470,"y":320,"id":1089},{"x":473,"y":318,"id":1090},{"x":475,"y":315,"id":1091},{"x":477,"y":314,"id":1092},{"x":479,"y":313,"id":1093},{"x":481,"y":311,"id":1094},{"x":482,"y":310,"id":1095},{"x":483,"y":308,"id":1096},{"x":485,"y":307,"id":1097},{"x":486,"y":305,"id":1098},{"x":488,"y":303,"id":1099},{"x":489,"y":302,"id":1100},{"x":491,"y":301,"id":1101},{"x":492,"y":300,"id":1102},{"x":494,"y":299,"id":1103},{"x":495,"y":297,"id":1104},{"x":499,"y":294,"id":1105},{"x":499,"y":293,"id":1106},{"x":501,"y":291,"id":1107},{"x":504,"y":288,"id":1108},{"x":505,"y":287,"id":1109},{"x":506,"y":286,"id":1110},{"x":507,"y":284,"id":1111},{"x":508,"y":283,"id":1112},{"x":510,"y":281,"id":1113},{"x":511,"y":280,"id":1114},{"x":512,"y":279,"id":1115},{"x":513,"y":277,"id":1116},{"x":514,"y":275,"id":1117},{"x":515,"y":274,"id":1118},{"x":517,"y":273,"id":1119},{"x":518,"y":271,"id":1120},{"x":519,"y":270,"id":1121},{"x":520,"y":268,"id":1122},{"x":522,"y":264,"id":1123},{"x":525,"y":262,"id":1124},{"x":526,"y":260,"id":1125},{"x":528,"y":258,"id":1126},{"x":529,"y":256,"id":1127},{"x":531,"y":255,"id":1128},{"x":532,"y":254,"id":1129},{"x":533,"y":253,"id":1130},{"x":534,"y":252,"id":1131},{"x":536,"y":250,"id":1132},{"x":539,"y":248,"id":1133},{"x":541,"y":247,"id":1134},{"x":546,"y":245,"id":1135},{"x":548,"y":243,"id":1136},{"x":549,"y":242,"id":1137},{"x":552,"y":241,"id":1138},{"x":554,"y":240,"id":1139},{"x":556,"y":239,"id":1140},{"x":557,"y":238,"id":1141},{"x":558,"y":238,"id":1142},{"x":559,"y":238,"id":1143},{"x":560,"y":237,"id":1144},{"x":561,"y":236,"id":1145},{"x":563,"y":235,"id":1146},{"x":565,"y":233,"id":1147},{"x":567,"y":232,"id":1148},{"x":569,"y":231,"id":1149},{"x":570,"y":229,"id":1150},{"x":573,"y":228,"id":1151},{"x":575,"y":227,"id":1152},{"x":578,"y":226,"id":1153},{"x":580,"y":224,"id":1154},{"x":581,"y":224,"id":1155},{"x":583,"y":222,"id":1156},{"x":586,"y":222,"id":1157},{"x":588,"y":220,"id":1158},{"x":590,"y":219,"id":1159},{"x":591,"y":219,"id":1160},{"x":592,"y":217,"id":1161},{"x":593,"y":217,"id":1162},{"x":595,"y":216,"id":1163},{"x":600,"y":214,"id":1164},{"x":603,"y":211,"id":1165},{"x":605,"y":210,"id":1166},{"x":606,"y":210,"id":1167},{"x":608,"y":209,"id":1168},{"x":610,"y":207,"id":1169},{"x":613,"y":205,"id":1170},{"x":616,"y":203,"id":1171},{"x":618,"y":202,"id":1172},{"x":620,"y":201,"id":1173},{"x":621,"y":200,"id":1174},{"x":624,"y":199,"id":1175},{"x":626,"y":197,"id":1176},{"x":628,"y":197,"id":1177},{"x":629,"y":196,"id":1178},{"x":632,"y":194,"id":1179},{"x":635,"y":193,"id":1180},{"x":638,"y":191,"id":1181},{"x":641,"y":190,"id":1182},{"x":644,"y":188,"id":1183},{"x":646,"y":187,"id":1184},{"x":649,"y":185,"id":1185},{"x":651,"y":184,"id":1186},{"x":652,"y":184,"id":1187},{"x":654,"y":183,"id":1188},{"x":655,"y":182,"id":1189},{"x":658,"y":181,"id":1190},{"x":660,"y":179,"id":1191},{"x":661,"y":179,"id":1192},{"x":663,"y":178,"id":1193},{"x":665,"y":177,"id":1194},{"x":667,"y":176,"id":1195},{"x":669,"y":175,"id":1196},{"x":671,"y":175,"id":1197},{"x":674,"y":173,"id":1198},{"x":676,"y":171,"id":1199},{"x":680,"y":170,"id":1200},{"x":682,"y":170,"id":1201},{"x":686,"y":168,"id":1202},{"x":689,"y":167,"id":1203},{"x":692,"y":166,"id":1204},{"x":696,"y":165,"id":1205},{"x":697,"y":164,"id":1206},{"x":698,"y":164,"id":1207},{"x":699,"y":164,"id":1208},{"x":700,"y":163,"id":1209},{"x":702,"y":162,"id":1210},{"x":703,"y":161,"id":1211},{"x":706,"y":160,"id":1212},{"x":710,"y":158,"id":1213},{"x":713,"y":158,"id":1214},{"x":715,"y":156,"id":1215},{"x":718,"y":155,"id":1216},{"x":719,"y":155,"id":1217},{"x":721,"y":154,"id":1218},{"x":722,"y":153,"id":1219},{"x":725,"y":152,"id":1220},{"x":727,"y":152,"id":1221},{"x":731,"y":150,"id":1222},{"x":733,"y":150,"id":1223},{"x":735,"y":149,"id":1224},{"x":738,"y":148,"id":1225},{"x":741,"y":147,"id":1226},{"x":745,"y":146,"id":1227},{"x":749,"y":145,"id":1228},{"x":751,"y":144,"id":1229},{"x":753,"y":144,"id":1230},{"x":754,"y":143,"id":1231},{"x":757,"y":143,"id":1232},{"x":761,"y":142,"id":1233},{"x":765,"y":140,"id":1234},{"x":769,"y":139,"id":1235},{"x":771,"y":138,"id":1236},{"x":773,"y":137,"id":1237},{"x":775,"y":136,"id":1238},{"x":777,"y":136,"id":1239},{"x":779,"y":135,"id":1240},{"x":781,"y":135,"id":1241},{"x":784,"y":133,"id":1242},{"x":786,"y":133,"id":1243},{"x":788,"y":132,"id":1244},{"x":791,"y":131,"id":1245},{"x":795,"y":131,"id":1246},{"x":799,"y":130,"id":1247},{"x":801,"y":129,"id":1248},{"x":803,"y":129,"id":1249},{"x":804,"y":128,"id":1250},{"x":805,"y":128,"id":1251},{"x":806,"y":127,"id":1252},{"x":808,"y":126,"id":1253},{"x":809,"y":126,"id":1254},{"x":810,"y":126,"id":1255},{"x":812,"y":125,"id":1256},{"x":815,"y":124,"id":1257},{"x":818,"y":123,"id":1258},{"x":820,"y":122,"id":1259},{"x":821,"y":121,"id":1260},{"x":823,"y":121,"id":1261},{"x":824,"y":120,"id":1262},{"x":826,"y":120,"id":1263},{"x":827,"y":120,"id":1264},{"x":828,"y":119,"id":1265},{"x":829,"y":119,"id":1266},{"x":830,"y":118,"id":1267},{"x":831,"y":118,"id":1268},{"x":832,"y":118,"id":1269},{"x":833,"y":118,"id":1270},{"x":833,"y":117,"id":1271},{"x":835,"y":117,"id":1272},{"x":836,"y":117,"id":1273},{"x":837,"y":117,"id":1274},{"x":838,"y":117,"id":1275},{"x":839,"y":117,"id":1276},{"x":840,"y":117,"id":1277},{"x":840,"y":118,"id":0},{"x":840,"y":119,"id":1},{"x":841,"y":123,"id":2}],
    majorAxis: [{"x":386,"y":519}, {"x":1612,"y":623}],
    minorAxis: [{"x":835,"y":121}, {"x":726,"y":829}]    
};

//Initialize Paper Canvas On Load
window.onload = function() {
    
    //Collect pressure and tilt data during sketching events
    // document.getElementById('sketchCanvas').addEventListener('pointerdown', function(event) {
    //     pressure = event.pressure;
    //     tiltx = event.tiltx;
    //     tilty = event.tilty;
        
    //     //Compute actual tilt
    //     var radianTiltx = tiltx * (Math.PI / 180);
    //     var radianTilty = tilty * (Math.PI / 180);
    //     var tanTiltx = Math.tan(radianTiltx);
    //     var tanTilty = Math.tan(radianTilty);
    //     var azix = Math.atan(tanTilty / tanTiltx);
    //     if (azix != 0) {
    //          tilt = Math.abs(Math.atan(Math.sin(azix) / tanTilty)) * (180 / Math.PI);
    //     }
    //     else {
    //         tilt = 90;
    //     }
    // })

    //Associate Paper JS with Canvas
    var canvas = document.getElementById('sketchCanvas');
    paper.setup(canvas);
    canvasWidth = paper.view.size.width;
    canvasHeight = paper.view.size.height;

    //Scale template sketches
    scaleSketches();

    //Set up ruler
    let ruler = new PlainDraggable(document.getElementById('ruler'));
    scaleRuler(speciesData.mmScale);

    //Activate sketch tool
    outline.activate();
    //generateOverlay();
    
    //Rescale function
    // paper.Raster.prototype.rescale = function(width, height) {
    //     this.scale(width / this.width, height / this.height);
    // };
}    

//Brush tools
let outline = new paper.Tool();
let axis = new paper.Tool();
let eraser = new paper.Tool();
let pointID = 0;

//Annotation brush
outline.onMouseDown = function(event) {
    path = new paper.Path();
    path.strokeColor = annotationColor;
    path.fillColor = fillColor;
    path.strokeWidth = 2;
    path.strokeCap = "round";

    //Save data
    let point = {x: event.point.x, y: event.point.y, id: pointID };
    pointData.push(point);
    pointID++;
}

outline.onMouseDrag = function(event) {
    path.add(event.point);

    //Save data
    let point = { x: event.point.x, y: event.point.y, id: pointID };
    pointData.push(point);
    pointID++;
}

outline.onMouseUp = function(event) { 
    path.smooth();
    sketch.push(path);
    
    //Save data
    strokeData.push(pointData);
    pointID = 0;

    
    //evaluateOutline(pointData, speciesData.outline);
}

//Axis brush
axis.onMouseDown = function(event) {
    path = new paper.Path();
    path.add(event.point);
    path.add(event.point);
    path.strokeColor = annotationColor;
    path.strokeWidth = 4;
    path.strokeCap = "round";
    path.dashArray = [20, 10];
}

axis.onMouseDrag = function(event) {
    path.segments[1].point = event.point;
}

axis.onMouseUp = function(event) { 
    sketch.push(path);

    evaluateAxis(path, speciesData, axisStep);
}

//Eraser tool
eraser.onMouseDown = erase;
eraser.onMouseDrag = erase;

function erase(event) {

    //dataChanged = true;
    let hits = paper.project.hitTestAll(event.point, {
        segments: true,
        fill: true,
        class: paper.Path,
        tolerance: 5,
        stroke: true
    });

    if (hits.length) {
        for (var i = 0; i < hits.length; i++) {
            let hit = hits[i];
            
            hit.item.remove();
        }
    }
}

//Ruler
function scaleRuler(scale) {
    let width = Math.floor(canvasWidth * scale);
    document.getElementById('ruler').style.width = ''+width+'px';
}

//let rulerRotated = 0;
// function rotateRuler() {
//     let rulerDOM = document.getElementById('ruler');
//     let rect = rulerDOM.getBoundingClientRect();
//     if (rulerRotated === 0) {
//         rulerDOM.style.top = rect.top;
//         rulerDOM.style.left = rect.left;
//         rulerDOM.className = "rotated";
//         rulerRotated = 1;
//     }
//     else {
//         console.log('hello..?');
//         rulerDOM.style.top = rect.top;
//         rulerDOM.style.left = rect.left;
//         rulerDOM.className = "";
//         rulerRotated = 0;
//     }
//     ruler = new PlainDraggable(document.getElementById('ruler'));
// }

//Scale sketch
function scaleSketches() {
    ratio = canvasWidth / speciesData.canvasWidth;
    for (let i = 0; i < speciesData.outline.length; i++) {
        speciesData.outline[i].x *= ratio;
        speciesData.outline[i].y *= ratio;
    }
    for (let i = 0; i < speciesData.majorAxis.length; i++) {
        speciesData.majorAxis[i].x *= ratio;
        speciesData.majorAxis[i].y *= ratio;
    }
    for (let i = 0; i < speciesData.minorAxis.length; i++) {
        speciesData.minorAxis[i].x *= ratio;
        speciesData.minorAxis[i].y *= ratio;
    }
}


function saveSketchData() {
    let sketchData = {
        species: 'whatever',
        variation: 'left',
        image: '',
        canvasWidth: canvasWidth,
        canvasHeight: canvasHeight,
        shape: '',
        size: '',
        ornamentation: '',

        //Sketch Data
        outline: strokeData,
        minorAxis: {},
        majorAxis: {},
        details: {}
    }

    let jsonData = JSON.stringify(sketchData);
    download(jsonData, 'json.txt', 'text/plain');

    pointData = [];
    strokeData = [];

    function download(content, fileName, contentType) {
        var a = document.createElement("a");
        var file = new Blob([content], {type: contentType});
        a.href = URL.createObjectURL(file);
        a.download = fileName;
        a.click();
    }
    

}

function showOutline() {
    outline = new paper.Path();
    outline.strokeColor = '#00aaaa';
    outline.strokeWidth = 4;
    outline.strokeCap = "round";
    for (i = 0; i < speciesData.outline.length; i++) {
        let point = new paper.Point(speciesData.outline[i].x, speciesData.outline[i].y);
        
        outline.add(point);
        
    }
    setTimeout(function() { outline.remove()}, 3000);
}

function showAxis(axis) {
    let pointA, pointB;
    
    //Which axis?
    if (axis === 'major') {
        pointA = new paper.Point(speciesData.majorAxis[0].x, speciesData.majorAxis[0].y);
        pointB = new paper.Point(speciesData.majorAxis[1].x, speciesData.majorAxis[1].y);
    }
    else {
        pointA = new paper.Point(speciesData.minorAxis[0].x, speciesData.minorAxis[0].y);
        pointB = new paper.Point(speciesData.minorAxis[1].x, speciesData.minorAxis[1].y);
    }

    //Display correct axis
    path = new paper.Path.Line(pointA, pointB);
    path.strokeColor = '#00aaaa';
    path.strokeWidth = 4;
    path.strokeCap = "round";
    path.dashArray = [20, 10];

    //Fade out axis
    setTimeout(function() { path.remove()}, 3000);
}

function evaluateAxis(path, template, axis) {
    
    //Which axis?
    let axisTemplate;
    if (axis === "major") {
        axisTemplate = template.majorAxis;
    }
    else {
        axisTemplate = template.minorAxis;
    }

    //Compute deviation
    let totalDeviation = 0;
    for (let i = 0; i < path.segments.length; i++) {
        let closestDist = 9999;
        let closestIndex = 0;
        for (let j = 0; j < axisTemplate.length; j++) {
            tempDist = checkDistance(path.segments[i].point, axisTemplate[j]);
            if (tempDist < closestDist) {
                closestDist = tempDist;
                closestIndex = j;
            }
        }
        totalDeviation += closestDist;
        
        //Show deviation
        // pointA = new paper.Point(resampledPath[i].x, resampledPath[i].y);
        // pointB = new paper.Point(resampledTemplate[closestIndex].x, resampledTemplate[closestIndex].y);
        // deviationPath = new paper.Path.Line(pointA ,pointB);
        // deviationPath.strokeColor = '#ff0000';
    }
    let avgDeviation = totalDeviation / 2;
    console.log('Average Deviation: '+avgDeviation);

    //Is it above threshold? Provide feedback
    if (avgDeviation > (canvasWidth / 50)) {
        showAxis(axis);
        showFeedback("negative");
        path.strokeColor = "#ff0000";

        setTimeout(function() { path.remove()}, 3000);
    }
    else {
        showFeedback("positive");
        path.strokeColor = "#00aaaa";
        nextStep();
    }
}

function showFeedback(type) {
    document.getElementById('sketchFeedback').className = "active";
    if (type === "positive") {
        document.getElementById('sketchFeedback').style.background = "#00aaaa";
        document.getElementById('sketchFeedback').innerHTML = "Great job!";
    }
    else if (type === "negative") {
        document.getElementById('sketchFeedback').style.background = "#ff0000";
        document.getElementById('sketchFeedback').innerHTML = "Not quite right";
    }
    setTimeout(function() { document.getElementById('sketchFeedback').className = "" }, 4000);
}

function strokeDistance(path) {
    var result = 0;
    for (let i=0; i < (path.length - 1); i++) {
        let deltax = path[i+1].x - path[i].x;
        let deltay = path[i+1].y - path[i].y;
        result = result + Math.sqrt((deltax*deltax)+(deltay*deltay));
    }
    return result;
}

function lengthBoundingBox(path) {
    let x = [];
    let y = [];
    for (let i = 0; i < path.length; i++) {
        x.push(path[i].x);
        y.push(path[i].x);
    }
    function getMaxOfArray(numArray) {
        return Math.max.apply(null, numArray);
    }
    function getMinOfArray(numArray) {
        return Math.min.apply(null, numArray);
    }
    var xmax = getMaxOfArray(x);
    var xmin = getMinOfArray(x);
    var ymax = getMaxOfArray(y);
    var ymin = getMinOfArray(y);

    var result = Math.sqrt(((xmax - xmin)*(xmax - xmin))+((ymax - ymin)*(ymax - ymin))); 
    return result;
}

function evaluateOutline(outline, template) {

    //Resample
    let resampledPath = resampledSketch(outline);
    let resampledTemplate = resampledSketch(template);

    //Find closest points in path and compute distance
    let totalDeviation = 0;
    for (let i = 0; i < resampledPath.length; i++) {
        let closestDist = 9999;
        let closestIndex = 0;
        for (let j = 0; j < resampledTemplate.length; j++) {
            tempDist = checkDistance(resampledPath[i], resampledTemplate[j]);
            if (tempDist < closestDist) {
                closestDist = tempDist;
                closestIndex = j;
            }
        }
        totalDeviation += closestDist;
        
        //Show deviation
        // pointA = new paper.Point(resampledPath[i].x, resampledPath[i].y);
        // pointB = new paper.Point(resampledTemplate[closestIndex].x, resampledTemplate[closestIndex].y);
        // deviationPath = new paper.Path.Line(pointA ,pointB);
        // deviationPath.strokeColor = '#ff0000';
    }
    avgDeviation = totalDeviation / resampledPath.length;
    console.log('Average Deviation: '+avgDeviation);
    if (avgDeviation < (canvasWidth / 100)) {
        showFeedback("positive");
        path.strokeColor = "#00aaaa";
        nextStep();
    }
    else {
        showFeedback("negative");
        setTimeout(function() { path.remove()}, 3000);
        path.strokeColor = "#ff0000";
        showOutline();
    }
}

function resampledSketch(path) {
    
    let S = strokeDistance(path) / 256;

    //Resampled points
    let resampled = [];
    //Push initial point of path
    resampled.push(path[0]);
    //Routine for determing remaining points 
    let D = 0;
    for (let i = 1; i < path.length; i++) {
        betweenDist = checkDistance(path[i], path[i-1]);
        D += betweenDist;
        if (D > S) {
            
            D = betweenDist;
            resampled.push(path[i]);            
        }
    }
    //Display points
    // for (let i = 0; i < resampled.length; i++) {
    //     let point = new paper.Point(resampled[i].x, resampled[i].y);
    //     let dot = new paper.Path.Circle(point, 4);
    //     dot.fillColor = '#00aaaa';
    // }

    return resampled;
}

function checkDistance(pointA, pointB) {
    let deltax = pointB.x - pointA.x;
    let deltay = pointB.y - pointA.y;
    result = Math.sqrt((deltax*deltax)+(deltay*deltay));
    return result;
}
